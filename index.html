<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>í•€ë³¼ ëœë¤ ë½‘ê¸°</title>

    <!-- OG -->
    <meta property="og:title" content="í•€ë³¼ ëœë¤ ë½‘ê¸°" />
    <meta
      property="og:description"
      content="í•€ë³¼ ê¸°ê³„ë¡œ ë¬´ì‘ìœ„ ìš°ìŠ¹ìë¥¼ ë½‘ì•„ë³´ì„¸ìš”! ğŸ±"
    />
    <meta
      property="og:image"
      content="https://dummyimage.com/1200x630/0f172a/ffffff&text=PINBALL+RANDOM"
    />

    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body
    class="bg-black text-white min-h-screen flex flex-col items-center py-6 overflow-hidden"
    style="
      background: linear-gradient(
        180deg,
        #0a0a0f 0%,
        #1a0a2e 50%,
        #0a0a0f 100%
      );
    "
  >
    <h1
      class="text-4xl font-extrabold mb-2 bg-gradient-to-r from-pink-500 via-cyan-500 to-purple-500 bg-clip-text text-transparent drop-shadow-[0_0_15px_rgba(236,72,153,0.5)]"
    >
      ğŸ± ë„¤ì˜¨ í•€ë³¼ ëœë¤ ë½‘ê¸°
    </h1>
    <p
      class="text-cyan-300 mb-6 text-lg drop-shadow-[0_0_10px_rgba(34,211,238,0.5)]"
    >
      ê³µì„ ë–¨ì–´ëœ¨ë ¤ ìš°ìŠ¹ìë¥¼ ë½‘ì•„ë³´ì„¸ìš”!
    </p>

    <!-- ì…ë ¥ ì˜ì—­ -->
    <div
      class="w-full max-w-md p-5 rounded-xl mb-4 border-2 border-cyan-500/30 shadow-[0_0_30px_rgba(34,211,238,0.3)]"
      style="
        background: linear-gradient(
          135deg,
          rgba(6, 182, 212, 0.1) 0%,
          rgba(168, 85, 247, 0.1) 100%
        );
      "
    >
      <label class="block mb-2 text-sm text-cyan-300 font-bold">
        ì°¸ê°€ì ì´ë¦„ ì…ë ¥ (ì‰¼í‘œë¡œ êµ¬ë¶„)
      </label>
      <textarea
        id="participantsInput"
        placeholder="ì˜ˆ: ì² ìˆ˜, ì˜í¬, ë¯¼ìˆ˜&#10;ë˜ëŠ” ê°œìˆ˜ ì§€ì •: ì² ìˆ˜2, ì˜í¬*3, ë¯¼ìˆ˜/5"
        class="w-full h-24 p-3 rounded text-sm mb-3 resize-none bg-black/50 border border-cyan-500/50 text-cyan-100 placeholder-cyan-500/50 focus:border-cyan-400 focus:shadow-[0_0_15px_rgba(34,211,238,0.5)] focus:outline-none"
      ></textarea>
      <p class="text-xs text-pink-300 mb-4">
        ğŸ’¡ ì´ë¦„ ë’¤ì— ìˆ«ì(ì² ìˆ˜2) ë˜ëŠ” ë³„í‘œ(ì˜í¬*3)ë¡œ ê³µ ê°œìˆ˜ ì§€ì • ê°€ëŠ¥
      </p>
      <button
        id="startBtn"
        class="w-full py-3 rounded-xl font-bold transition-all duration-300 transform hover:scale-105 shadow-[0_0_20px_rgba(34,211,238,0.5)]"
        style="background: linear-gradient(135deg, #06b6d4 0%, #8b5cf6 100%)"
      >
        ê²Œì„ ì‹œì‘ ğŸš€
      </button>
    </div>

    <!-- Canvas Container -->
    <div
      id="canvasContainer"
      class="hidden relative w-full max-w-lg overflow-hidden rounded-xl border-2 border-cyan-500/50 shadow-[0_0_50px_rgba(34,211,238,0.4)]"
      style="height: 80vh"
    >
      <canvas
        id="pinballCanvas"
        width="500"
        height="2000"
        class="block"
        style="
          background: linear-gradient(
            180deg,
            #0a0a0f 0%,
            #1a0a2e 30%,
            #0a0a0f 60%,
            #1a0a2e 100%
          );
        "
      ></canvas>
    </div>

    <!-- ê²°ê³¼ -->
    <div
      id="result"
      class="hidden mt-6 bg-slate-800 p-5 rounded-xl w-full max-w-md"
    ></div>

    <script>
      /* ---------------- ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ ---------------- */
      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

      /* ---------------- íš¨ê³¼ìŒ í•¨ìˆ˜ ---------------- */
      function playSound(type = "bounce") {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();

        osc.connect(gain);
        gain.connect(audioCtx.destination);

        if (type === "bounce") {
          osc.frequency.value = 400;
          osc.type = "square";
          gain.gain.value = 0.05;
          osc.start();
          osc.frequency.exponentialRampToValueAtTime(
            200,
            audioCtx.currentTime + 0.1
          );
          gain.gain.exponentialRampToValueAtTime(
            0.001,
            audioCtx.currentTime + 0.1
          );
          osc.stop(audioCtx.currentTime + 0.1);
        }

        if (type === "finish") {
          osc.frequency.value = 300;
          osc.type = "sawtooth";
          gain.gain.value = 0.12;
          osc.start();
          osc.frequency.exponentialRampToValueAtTime(
            80,
            audioCtx.currentTime + 0.4
          );
          gain.gain.exponentialRampToValueAtTime(
            0.001,
            audioCtx.currentTime + 0.4
          );
          osc.stop(audioCtx.currentTime + 0.4);
        }
      }

      /* ---------------- ì§„ë™ í•¨ìˆ˜ ---------------- */
      function vibrate(ms = 20) {
        if (navigator.vibrate) {
          navigator.vibrate(ms);
        }
      }

      /* ---------------- ìƒíƒœ ---------------- */
      let balls = [];
      let pins = [];
      let finishedBalls = [];
      let animationId;
      let participants = [];
      let cameraY = 0;
      let targetCameraY = 0;
      const canvasContainer = document.getElementById("canvasContainer");

      /* ---------------- DOM ---------------- */
      const canvas = document.getElementById("pinballCanvas");
      const ctx = canvas.getContext("2d");
      const resultEl = document.getElementById("result");
      const participantsInput = document.getElementById("participantsInput");

      /* ---------------- ì°¸ê°€ì íŒŒì‹± ---------------- */
      function parseParticipants(text) {
        const lines = text
          .split(/[,\n]/)
          .map((s) => s.trim())
          .filter((s) => s);
        const result = [];

        lines.forEach((line) => {
          let name = line;
          let count = 1;

          // ìˆ«ìë¡œ ê°œìˆ˜ ì§€ì • (ì² ìˆ˜2)
          const numMatch = line.match(/^(.+?)(\d+)$/);
          if (numMatch) {
            name = numMatch[1];
            count = parseInt(numMatch[2]);
          } else {
            // ë³„í‘œë¡œ ê°œìˆ˜ ì§€ì • (ì˜í¬*3)
            const starMatch = line.match(/^(.+?)\*(\d+)$/);
            if (starMatch) {
              name = starMatch[1];
              count = parseInt(starMatch[2]);
            }
          }

          for (let i = 0; i < count; i++) {
            result.push(name);
          }
        });

        return result;
      }

      /* ---------------- í•€ ì´ˆê¸°í™” ---------------- */
      function initPins() {
        pins = [];
        const pinCount = 60; // ì›í˜• í•€
        const barCount = 30; // ë§‰ëŒ€ê¸° ì¥ì• ë¬¼

        const neonColors = [
          "#ff00ff", // í•‘í¬
          "#00ffff", // ì‹œì•ˆ
          "#ff00ff", // ë§ˆì  íƒ€
          "#00ff00", // ë¼ì„
          "#ffff00", // ì˜ë¡œìš°
          "#ff0080", // í•‘í¬
          "#0080ff", // ë¸”ë£¨
        ];

        // ì›í˜• í•€
        for (let i = 0; i < pinCount; i++) {
          pins.push({
            type: "circle",
            x: Math.random() * (canvas.width - 40) + 20,
            y: 150 + Math.random() * (canvas.height - 400),
            r: 8 + Math.random() * 4,
            color: neonColors[Math.floor(Math.random() * neonColors.length)],
            glow: Math.random() * 0.5 + 0.5,
          });
        }

        // ê¸°ìš¸ì–´ì§„ ë§‰ëŒ€ê¸° ì¥ì• ë¬¼
        for (let i = 0; i < barCount; i++) {
          const length = 40 + Math.random() * 50;
          const angle = Math.random() * Math.PI; // 0~180ë„ íšŒì „
          pins.push({
            type: "bar",
            x: Math.random() * (canvas.width - 60) + 30,
            y: 150 + Math.random() * (canvas.height - 400),
            length: length,
            width: 8,
            angle: angle,
            color: neonColors[Math.floor(Math.random() * neonColors.length)],
          });
        }
      }

      /* ---------------- ê³µ ì´ˆê¸°í™” ---------------- */
      function initBalls() {
        balls = [];
        const shuffled = [...participants].sort(() => Math.random() - 0.5);

        const neonColors = [
          "#ff00ff",
          "#00ffff",
          "#ff0080",
          "#00ff00",
          "#ffff00",
          "#ff00ff",
          "#0080ff",
          "#ff8000",
        ];

        shuffled.forEach((name, i) => {
          balls.push({
            name,
            x: canvas.width / 2 + (Math.random() - 0.5) * 40,
            y: 20,
            r: 14,
            vx: (Math.random() - 0.5) * 2,
            vy: 0,
            finished: false,
            finishOrder: null,
            color: neonColors[i % neonColors.length],
          });
        });
      }

      /* ---------------- í•€ ê·¸ë¦¬ê¸° (ë„¤ì˜¨ íš¨ê³¼) ---------------- */
      function drawPin(pin) {
        ctx.shadowBlur = 15;
        ctx.shadowColor = pin.color;

        if (pin.type === "circle") {
          ctx.beginPath();
          ctx.arc(pin.x, pin.y, pin.r, 0, Math.PI * 2);
          ctx.fillStyle = pin.color;
          ctx.fill();

          ctx.strokeStyle = pin.color;
          ctx.lineWidth = 2;
          ctx.stroke();

          // ë‚´ë¶€ í•˜ì´ë¼ì´íŠ¸
          ctx.beginPath();
          ctx.arc(
            pin.x - pin.r * 0.3,
            pin.y - pin.r * 0.3,
            pin.r * 0.4,
            0,
            Math.PI * 2
          );
          ctx.fillStyle = "rgba(255, 255, 255, 0.6)";
          ctx.fill();
        } else if (pin.type === "bar") {
          // íšŒì „ëœ ë§‰ëŒ€ê¸° ê·¸ë¦¬ê¸°
          ctx.save();
          ctx.translate(pin.x, pin.y);
          ctx.rotate(pin.angle);

          ctx.fillStyle = pin.color;
          ctx.fillRect(-pin.length / 2, -pin.width / 2, pin.length, pin.width);
          ctx.strokeStyle = pin.color;
          ctx.lineWidth = 2;
          ctx.strokeRect(
            -pin.length / 2,
            -pin.width / 2,
            pin.length,
            pin.width
          );

          ctx.restore();
        }

        ctx.shadowBlur = 0;
      }

      /* ---------------- ê³µ ê·¸ë¦¬ê¸° (ë„¤ì˜¨ íš¨ê³¼) ---------------- */
      function drawBall(ball) {
        // ê¸€ë¡œìš° íš¨ê³¼
        ctx.shadowBlur = 20;
        ctx.shadowColor = ball.color;

        // ì™¸ê³½ ê¸€ë¡œìš°
        ctx.beginPath();
        ctx.arc(ball.x, ball.y, ball.r + 3, 0, Math.PI * 2);
        ctx.fillStyle = ball.color + "40";
        ctx.fill();

        // ë©”ì¸ ê³µ
        ctx.beginPath();
        ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2);
        const gradient = ctx.createRadialGradient(
          ball.x - ball.r * 0.3,
          ball.y - ball.r * 0.3,
          0,
          ball.x,
          ball.y,
          ball.r
        );
        gradient.addColorStop(0, ball.color + "FF");
        gradient.addColorStop(1, ball.color + "CC");
        ctx.fillStyle = gradient;
        ctx.fill();

        ctx.strokeStyle = ball.color;
        ctx.lineWidth = 2;
        ctx.stroke();

        // í•˜ì´ë¼ì´íŠ¸
        ctx.beginPath();
        ctx.arc(
          ball.x - ball.r * 0.3,
          ball.y - ball.r * 0.3,
          ball.r * 0.4,
          0,
          Math.PI * 2
        );
        ctx.fillStyle = "rgba(255, 255, 255, 0.7)";
        ctx.fill();

        ctx.shadowBlur = 0;

        // ì´ë¦„ í‘œì‹œ (ë„¤ì˜¨ í…ìŠ¤íŠ¸)
        ctx.shadowBlur = 10;
        ctx.shadowColor = ball.color;
        ctx.fillStyle = "#fff";
        ctx.font = "bold 11px sans-serif";
        ctx.textAlign = "center";
        ctx.fillText(ball.name.slice(0, 2), ball.x, ball.y + 4);
        ctx.shadowBlur = 0;
      }

      /* ---------------- ì¶©ëŒ ê°ì§€ ---------------- */
      function checkCollision(ball, pin) {
        if (pin.type === "circle") {
          const dx = ball.x - pin.x;
          const dy = ball.y - pin.y;
          const distance = Math.sqrt(dx * dx + dy * dy);
          return distance < ball.r + pin.r;
        } else if (pin.type === "bar") {
          // íšŒì „ëœ ë§‰ëŒ€ê¸°ì™€ ê³µì˜ ì¶©ëŒ ê°ì§€
          const dx = ball.x - pin.x;
          const dy = ball.y - pin.y;
          const cos = Math.cos(-pin.angle);
          const sin = Math.sin(-pin.angle);
          const localX = dx * cos - dy * sin;
          const localY = dx * sin + dy * cos;

          const closestX = Math.max(
            -pin.length / 2,
            Math.min(localX, pin.length / 2)
          );
          const closestY = Math.max(
            -pin.width / 2,
            Math.min(localY, pin.width / 2)
          );

          const distX = localX - closestX;
          const distY = localY - closestY;
          return distX * distX + distY * distY < ball.r * ball.r;
        }
        return false;
      }

      /* ---------------- ì¹´ë©”ë¼ ì—…ë°ì´íŠ¸ ---------------- */
      function updateCamera() {
        if (balls.length === 0) return;

        // 1ìœ„ ê³µ (ê°€ì¥ yê°’ì´ í° ê³µ = ê°€ì¥ ì•ì„  ê³µ) ì°¾ê¸°
        const activeBalls = balls.filter((b) => !b.finished);
        if (activeBalls.length > 0) {
          // ê°€ì¥ ì•ì„  ê³µ ì°¾ê¸°
          const leadingBall = activeBalls.reduce((prev, curr) =>
            curr.y > prev.y ? curr : prev
          );

          // íƒ€ê²Ÿ ì¹´ë©”ë¼ ìœ„ì¹˜ ì„¤ì •
          targetCameraY = Math.max(
            0,
            Math.min(
              leadingBall.y - canvasContainer.clientHeight / 2,
              canvas.height - canvasContainer.clientHeight
            )
          );

          // ë¶€ë“œëŸ¬ìš´ ì¹´ë©”ë¼ ì´ë™ (lerp)
          const lerpFactor = 0.1; // 0.1 = ë¶€ë“œëŸ½ê²Œ, 1.0 = ì¦‰ì‹œ
          cameraY += (targetCameraY - cameraY) * lerpFactor;
        }
      }

      /* ---------------- ì• ë‹ˆë©”ì´ì…˜ ---------------- */
      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // ì¹´ë©”ë¼ ë³€í™˜
        ctx.save();
        ctx.translate(0, -cameraY);

        // ë°°ê²½ ê·¸ë¦¬ë“œ (ë„¤ì˜¨ íš¨ê³¼)
        ctx.strokeStyle = "#00ffff22";
        ctx.lineWidth = 1;
        for (let i = 0; i < canvas.width; i += 50) {
          ctx.beginPath();
          ctx.moveTo(i, 0);
          ctx.lineTo(i, canvas.height);
          ctx.stroke();
        }
        for (let i = 0; i < canvas.height; i += 50) {
          ctx.beginPath();
          ctx.moveTo(0, i);
          ctx.lineTo(canvas.width, i);
          ctx.stroke();
        }

        // í•€ ê·¸ë¦¬ê¸°
        pins.forEach((pin) => drawPin(pin));

        // ê²°ìŠ¹ì„  (ë„¤ì˜¨ íš¨ê³¼)
        ctx.shadowBlur = 20;
        ctx.shadowColor = "#ffff00";
        ctx.strokeStyle = "#ffff00";
        ctx.lineWidth = 5;
        ctx.setLineDash([20, 10]);
        ctx.beginPath();
        ctx.moveTo(0, canvas.height - 50);
        ctx.lineTo(canvas.width, canvas.height - 50);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.shadowBlur = 0;

        // FINISH í…ìŠ¤íŠ¸ (ë„¤ì˜¨ íš¨ê³¼)
        ctx.shadowBlur = 25;
        ctx.shadowColor = "#ffff00";
        ctx.fillStyle = "#ffff00";
        ctx.font = "bold 28px sans-serif";
        ctx.textAlign = "center";
        ctx.fillText("FINISH", canvas.width / 2, canvas.height - 70);
        ctx.shadowBlur = 0;

        // ì¤‘ë ¥ ì ìš©
        balls.forEach((ball) => {
          if (ball.finished) return;

          ball.vy += 0.3; // ì¤‘ë ¥
          ball.x += ball.vx;
          ball.y += ball.vy;

          // í•€ê³¼ ì¶©ëŒ
          pins.forEach((pin) => {
            if (checkCollision(ball, pin)) {
              if (pin.type === "circle") {
                const dx = ball.x - pin.x;
                const dy = ball.y - pin.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance > 0) {
                  // íŠ•ê¸°ê¸°
                  const overlap = ball.r + pin.r - distance;
                  ball.x += (dx / distance) * overlap * 1.1;
                  ball.y += (dy / distance) * overlap * 1.1;

                  const angle = Math.atan2(dy, dx);
                  const speed = Math.sqrt(
                    ball.vx * ball.vx + ball.vy * ball.vy
                  );
                  const bounceForce = speed * 0.8;
                  ball.vx = Math.cos(angle) * bounceForce;
                  ball.vy = Math.sin(angle) * bounceForce;

                  playSound("bounce");
                  vibrate(10);
                }
              } else if (pin.type === "bar") {
                // íšŒì „ëœ ë§‰ëŒ€ê¸° ì¶©ëŒ
                const dx = ball.x - pin.x;
                const dy = ball.y - pin.y;
                const cos = Math.cos(-pin.angle);
                const sin = Math.sin(-pin.angle);
                const localX = dx * cos - dy * sin;
                const localY = dx * sin + dy * cos;

                const closestX = Math.max(
                  -pin.length / 2,
                  Math.min(localX, pin.length / 2)
                );
                const closestY = Math.max(
                  -pin.width / 2,
                  Math.min(localY, pin.width / 2)
                );

                const worldClosestX = pin.x + closestX * cos - closestY * sin;
                const worldClosestY = pin.y + closestX * sin + closestY * cos;

                const distX = ball.x - worldClosestX;
                const distY = ball.y - worldClosestY;
                const distance = Math.sqrt(distX * distX + distY * distY);

                if (distance > 0) {
                  const overlap = ball.r - distance;
                  ball.x += (distX / distance) * overlap * 1.1;
                  ball.y += (distY / distance) * overlap * 1.1;

                  // ë§‰ëŒ€ê¸°ì˜ ë²•ì„  ë²¡í„°ë¥¼ ë”°ë¼ íŠ•ê¸°ê¸°
                  const normalX = Math.cos(pin.angle + Math.PI / 2);
                  const normalY = Math.sin(pin.angle + Math.PI / 2);
                  const dot = ball.vx * normalX + ball.vy * normalY;
                  ball.vx -= 2 * dot * normalX * 1.2;
                  ball.vy -= 2 * dot * normalY * 1.2;
                  ball.vx *= 0.9;
                  ball.vy *= 0.9;

                  playSound("bounce");
                  vibrate(10);
                }
              }
            }
          });

          // ê³µë¼ë¦¬ ì¶©ëŒ
          balls.forEach((other) => {
            if (ball === other || other.finished) return;

            const dx = ball.x - other.x;
            const dy = ball.y - other.y;
            const distance = Math.sqrt(dx * dx + dy * dy);

            if (distance < ball.r + other.r && distance > 0) {
              const overlap = ball.r + other.r - distance;
              ball.x += (dx / distance) * overlap * 0.5;
              ball.y += (dy / distance) * overlap * 0.5;

              const angle = Math.atan2(dy, dx);
              const speed1 = Math.sqrt(ball.vx * ball.vx + ball.vy * ball.vy);
              const speed2 = Math.sqrt(
                other.vx * other.vx + other.vy * other.vy
              );
              const bounceForce = (speed1 + speed2) * 0.3;

              ball.vx += Math.cos(angle) * bounceForce;
              ball.vy += Math.sin(angle) * bounceForce;
            }
          });

          // ê²½ê³„ ì²´í¬
          if (ball.x < ball.r) {
            ball.x = ball.r;
            ball.vx *= -0.7;
          }
          if (ball.x > canvas.width - ball.r) {
            ball.x = canvas.width - ball.r;
            ball.vx *= -0.7;
          }

          // ê²°ìŠ¹ì„  í†µê³¼
          if (ball.y >= canvas.height - 50 && !ball.finished) {
            ball.finished = true;
            ball.finishOrder = finishedBalls.length + 1;
            finishedBalls.push(ball);
            playSound("finish");
            vibrate(50);

            // ì²« ë²ˆì§¸ ì™„ì£¼ì
            if (finishedBalls.length === 1) {
              playSound("finish");
              vibrate([100, 50, 100]);
            }
          }

          if (!ball.finished) drawBall(ball);
        });

        // ì™„ì£¼í•œ ê³µ í‘œì‹œ
        finishedBalls.forEach((ball) => {
          ctx.save();
          ctx.globalAlpha = 0.8;
          drawBall(ball);
          ctx.restore();

          // ìˆœìœ„ í‘œì‹œ (ë„¤ì˜¨ íš¨ê³¼)
          ctx.shadowBlur = 15;
          ctx.shadowColor = "#ffff00";
          ctx.fillStyle = "#ffff00";
          ctx.font = "bold 16px sans-serif";
          ctx.fillText(`${ball.finishOrder}ìœ„`, ball.x, ball.y - ball.r - 8);
          ctx.shadowBlur = 0;
        });

        ctx.restore(); // ì¹´ë©”ë¼ ë³€í™˜ ë³µì›

        // ì¹´ë©”ë¼ ì—…ë°ì´íŠ¸
        updateCamera();

        // ëª¨ë“  ê³µì´ ì™„ì£¼í–ˆëŠ”ì§€ ì²´í¬
        if (balls.every((b) => b.finished)) {
          cancelAnimationFrame(animationId);
          showResult();
          return;
        }

        animationId = requestAnimationFrame(animate);
      }

      /* ---------------- ê²°ê³¼ í‘œì‹œ ---------------- */
      function showResult() {
        resultEl.classList.remove("hidden");
        const sorted = [...finishedBalls].sort(
          (a, b) => a.finishOrder - b.finishOrder
        );

        resultEl.innerHTML = `
          <h2 class="text-2xl font-bold mb-4 text-center">ğŸ ì™„ì£¼ ìˆœìœ„</h2>
          <div class="space-y-2 max-h-96 overflow-y-auto">
            ${sorted
              .map(
                (ball, i) => `
              <div class="flex items-center gap-3 p-3 rounded-lg ${
                i === 0
                  ? "bg-yellow-500/20 border-2 border-yellow-500"
                  : i < 3
                  ? "bg-slate-700"
                  : "bg-slate-700/50"
              }">
                <span class="text-2xl font-bold w-10 text-center">${
                  i + 1
                }</span>
                <div class="flex-1">
                  <div class="font-bold">${ball.name}</div>
                  <div class="text-xs text-slate-400">${
                    ball.finishOrder
                  }ë²ˆì§¸ë¡œ ì™„ì£¼</div>
                </div>
                ${
                  i === 0
                    ? '<span class="text-2xl">ğŸ†</span>'
                    : i === 1
                    ? '<span class="text-xl">ğŸ¥ˆ</span>'
                    : i === 2
                    ? '<span class="text-xl">ğŸ¥‰</span>'
                    : ""
                }
              </div>
            `
              )
              .join("")}
          </div>
          <button
            onclick="location.reload()"
            class="w-full mt-4 py-3 rounded-xl bg-emerald-400 text-black font-bold hover:bg-emerald-300 transition"
          >
            ë‹¤ì‹œ í•˜ê¸° ğŸ”„
          </button>
        `;
      }

      /* ---------------- ê²Œì„ ì‹œì‘ ---------------- */
      document.getElementById("startBtn").onclick = () => {
        const input = participantsInput.value.trim();
        if (!input) {
          alert("ì°¸ê°€ì ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
          return;
        }

        participants = parseParticipants(input);
        if (participants.length === 0) {
          alert("ì°¸ê°€ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
          return;
        }

        canvasContainer.classList.remove("hidden");
        resultEl.classList.add("hidden");
        document
          .getElementById("startBtn")
          .parentElement.classList.add("hidden");

        initPins();
        initBalls();
        finishedBalls = [];
        cameraY = 0;
        animate();
      };
    </script>
  </body>
</html>
